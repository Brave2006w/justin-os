name: justin-os-surface
description: Surface Pro 7 variant with KDE and linux-surface kernel
base-image: ghcr.io/ublue-os/silverblue-main
image-version: 42

modules:
  # Add linux-surface repo FIRST
  - type: rpm-ostree
    repos:
      - https://pkg.surfacelinux.com/fedora/linux-surface.repo

  # Import all your existing modules
  - from-file: common-repos.yml
  - from-file: common-packages.yml
  - from-file: surface-flatpaks.yml
  - from-file: vpn-fix.yml

  # Surface-specific packages
  - type: rpm-ostree
    install:
      - kernel-surface
      - kernel-surface-default-watchdog
      - iptsd
      - libwacom-surface
      - libwacom-surface-data
      - surface-secureboot
      - thermald
    remove:
      - kernel
      - kernel-core
      - kernel-modules
      - kernel-modules-core
      - kernel-modules-extra
      - libwacom
      - libwacom-data

  # Enable thermald for better thermal management
  - type: systemd
    system:
      enabled:
        - thermald.service

  - type: signing
